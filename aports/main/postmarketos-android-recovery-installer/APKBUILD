pkgname=postmarketos-android-recovery-installer
pkgver=0.0.1
pkgrel=1
pkgdesc="TWRP compatible postmarketOS installer script"
url="https://github.com/postmarketOS"
# multipath-tools: kpartx
depends="busybox-extras lddtree cryptsetup multipath-tools device-mapper parted zip"
source="build_zip.sh
	update-binary
	pmos_install
	pmos_install_functions
	pmos_setpw"
arch="noarch"
license="GPL3"

package() {
	install -Dm755 "$srcdir/build_zip.sh" \
		"$pkgdir/sbin/build-recovery-zip"
	mkdir -p "$pkgdir/var/lib/postmarketos-android-recovery-installer/META-INF/com/google/android/"
	install -Dm644 "$srcdir"/update-binary \
		"$pkgdir/var/lib/postmarketos-android-recovery-installer/META-INF/com/google/android/update-binary"
	mkdir "$pkgdir/var/lib/postmarketos-android-recovery-installer/bin/"
	for file in pmos_install pmos_install_functions pmos_setpw; do
		install -Dm755 "$srcdir/$file" \
			"$pkgdir/var/lib/postmarketos-android-recovery-installer/bin/$file"
	done
	mkdir "$pkgdir/var/lib/postmarketos-android-recovery-installer/lib/"
}
sha512sums="42da74e5fa2ca17d906b04fe22995f0eb83b16f0adacf1cd76d93243eebd804d1fe10daf1ae1726303c47748fe1c0656b2cab6b3ea3aeb874ba73e05ecbf1b1d  build_zip.sh
e5c46810d0e2bf85e646bba1b0962d04b5b35b91f8a596bd3f806b4a6e8a801040193c0950847501073166ab87ac097b291aad1e7a27b4877d5ff8bac297b3db  update-binary
83f3b0be75f4512160ee8120de6cc4796425fe732a674a2f6f164c648e4e518ec5c7193c196a844da9346e5bf61337e98261d7d212854638ef70541549f2b0b2  pmos_install
21981f5f56c1c253982d47b71cd0e1e4febfc65ec060d1baab010dc6f8b10e02c14d97f09388d39c1dfc8a50e0b7b5f8136ea8d28b3cf861ec2a76c19ef4901d  pmos_install_functions
ac6d7d7844be74fdb9cd9ee88031a26587af80d403edcfebf2820deaf61757fa360c2cd00cca2572b45d3f27b4d423bcb1274cc551cc67560e06c65f877a5f1a  pmos_setpw"
