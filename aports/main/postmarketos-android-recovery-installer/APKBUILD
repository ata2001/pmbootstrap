pkgname=postmarketos-android-recovery-installer
pkgver=0.0.1
pkgrel=1
pkgdesc="TWRP compatible postmarketOS installer script"
url="https://github.com/postmarketOS"
# multipath-tools: kpartx
depends="busybox-extras lddtree cryptsetup multipath-tools device-mapper parted zip"
source="build_zip.sh
	update-binary
	pmos_install
	pmos_install_functions
	pmos_setpw"
arch="noarch"
license="GPL3"

package() {
	install -Dm755 "$srcdir/build_zip.sh" \
		"$pkgdir/sbin/build-recovery-zip"
	mkdir -p "$pkgdir/var/lib/postmarketos-android-recovery-installer/META-INF/com/google/android/"
	install -Dm644 "$srcdir"/update-binary \
		"$pkgdir/var/lib/postmarketos-android-recovery-installer/META-INF/com/google/android/update-binary"
	mkdir "$pkgdir/var/lib/postmarketos-android-recovery-installer/bin/"
	for file in pmos_install pmos_install_functions pmos_setpw; do
		install -Dm755 "$srcdir/$file" \
			"$pkgdir/var/lib/postmarketos-android-recovery-installer/bin/$file"
	done
	mkdir "$pkgdir/var/lib/postmarketos-android-recovery-installer/lib/"
}
sha512sums="002c6c359a24bfc439c7f4349a36ad7a6a580fc3fbda2de9ec2db7e5093bc0521ce31a3cb8aab1e8c6b7d9d12ca688a165cc337e30c53cc67ed67e1e57cf2f3d  build_zip.sh
090fed721867647f036e1bb9862112d2bfb01ba7bd63f373f43742fcfafb0fc8decf9a30b36361036ba4ddda51ae9cd4f29612e0ddb3774cce39a5e3d6359326  update-binary
6eab6bf7fa4580d36a558a8386dd8331666ff21d665b361c84c5305967aee7484f6e280ace37427a837f647023aacbbcecdf0ba65443229f75c3708ca525c8f6  pmos_install
399fa573d1bec3c6711f8669af816a1b636c3b14127ab2645d07d84da18d7abe15b2ddf5871446b6e6c2fb4d5b130c22160f89c507352f63c3ce9d25958c1f5e  pmos_install_functions
23ee28b9ede3ceacb022b0c77433f4a3689d8173ab74ad71ce502cf5a2aa87e5922060a2f1f4e7cd51a7085e25582bc055040172bb117c5ed0a42ca3e85937fc  pmos_setpw"
