pkgname=postmarketos-android-recovery-installer
pkgver=0.0.1
pkgrel=1
pkgdesc="TWRP compatible postmarketOS installer script"
url="https://github.com/postmarketOS"
# multipath-tools: kpartx
depends="busybox-extras lddtree cryptsetup multipath-tools device-mapper parted zip"
source="build_zip.sh
	update-binary
	pmos_install
	pmos_install_functions
	pmos_setpw"
arch="noarch"
license="GPL3"

package() {
	mkdir -p "$pkgdir/usr/sahre/postmarketos-android-recovery-installer/"
	install -Dm755 "$srcdir/build_zip.sh" \
		"$pkgdir/sbin/build-recovery-zip"
	mkdir -p "$pkgdir/usr/share/postmarketos-android-recovery-installer/META-INF/com/google/android/"
	install -Dm644 "$srcdir"/update-binary \
		"$pkgdir/usr/share/postmarketos-android-recovery-installer/META-INF/com/google/android/update-binary"
	mkdir -p "$pkgdir/usr/sahre/postmarketos-android-recovery-installer/bin/"
	for file in pmos_install pmos_install_functions pmos_setpw; do
		install -Dm755 "$srcdir/$file" \
			"$pkgdir/usr/share/postmarketos-android-recovery-installer/bin/$file"
	done
	mkdir -p "$pkgdir/usr/sahre/postmarketos-android-recovery-installer/lib/"
}
sha512sums="3767d9cc170738c1e3d7a510844198882dd8ced8b9e450b4e2b34cf306628eae790757ac8249c5da7a1b7e8dedd3765d7ca15c7bb61bfdd4b51465557e897eab  build_zip.sh
47be5b2954e1633a5601620e876a378207707f786710a2228b8aebc7f2ecc0357dbca6beacd407508dfdf65e8372ed0212609cea92100b7cd17dcb28c06e38e1  update-binary
43b88ab00d0827d58d1c1a91fd9248d2b335e50bd6fd31ab38034eb2e10c48e1990b8bd69ffd9440090370e5207dd88a3aae5d5e2f76f8dd9e9f6030e8d6acd5  pmos_install
c1f6172a1f505ae7cd6e2ae0a9be21c7af56a90d0729585f46ad347c0db736198f3c0fdd968593131f35fb1cd76783b2b720703ede01efcb744d355dedf18492  pmos_install_functions
ed3b1002b494b51d85fd29c0efe4511eba670f997598d6940859a4a0ce0e236fff1d4e7efcbd617407ef2db135c3f6eb8cf1f13041b05c88a43aa63a43482750  pmos_setpw"
