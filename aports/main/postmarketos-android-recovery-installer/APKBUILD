pkgname=postmarketos-android-recovery-installer
pkgver=0.0.1
pkgrel=1
pkgdesc="TWRP compatible postmarketOS installer script"
url="https://github.com/postmarketOS"
# multipath-tools: kpartx
depends="busybox-extras lddtree cryptsetup multipath-tools device-mapper parted zip"
source="build_zip.sh
	update-binary
	pmos_install
	pmos_install_functions
	pmos_setpw"
arch="noarch"
license="GPL3"

package() {
	install -Dm755 "$srcdir/build_zip.sh" \
		"$pkgdir/sbin/build-recovery-zip"
	mkdir -p "$pkgdir/usr/share/postmarketos-android-recovery-installer/META-INF/com/google/android/"
	install -Dm644 "$srcdir"/update-binary \
		"$pkgdir/usr/share/postmarketos-android-recovery-installer/META-INF/com/google/android/update-binary"
	mkdir -p "$pkgdir/usr/sahre/postmarketos-android-recovery-installer/bin/"
	for file in pmos_install pmos_install_functions pmos_setpw; do
		install -Dm755 "$srcdir/$file" \
			"$pkgdir/usr/share/postmarketos-android-recovery-installer/bin/$file"
	done
	mkdir -p "$pkgdir/usr/sahre/postmarketos-android-recovery-installer/lib/"
}
sha512sums="f5e42954dcdd1fbca89f83ab002e8604b7105efbfacdf9618d7a8dc3a9e20a2a50df9823e63ddb289c2e423a63317edbc007cf14f7699baaaeda3520f2fb4164  build_zip.sh
47be5b2954e1633a5601620e876a378207707f786710a2228b8aebc7f2ecc0357dbca6beacd407508dfdf65e8372ed0212609cea92100b7cd17dcb28c06e38e1  update-binary
0263acd0987566940499cb2b8b59257000fc7841850e34f0fdd48bbea42270f2ee0a31ed64d435c78136ec3d02108d53fe32a372306454313447d48e47fa441a  pmos_install
21981f5f56c1c253982d47b71cd0e1e4febfc65ec060d1baab010dc6f8b10e02c14d97f09388d39c1dfc8a50e0b7b5f8136ea8d28b3cf861ec2a76c19ef4901d  pmos_install_functions
ac6d7d7844be74fdb9cd9ee88031a26587af80d403edcfebf2820deaf61757fa360c2cd00cca2572b45d3f27b4d423bcb1274cc551cc67560e06c65f877a5f1a  pmos_setpw"
